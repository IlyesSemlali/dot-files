#!/bin/bash

# Generate lockscreen wallpaper
if ! [ -f ~/.lockscreen.png ]
then
	convert ~/.wallpaper \
		-resize 160x100 \
		-gaussian-blur 30 \
		-colorspace gray \
		-gamma 0.5 \
		-resize "$(xrandr | grep \* | awk '{print $1}')!" ~/.lockscreen.png
fi


if [[ $1 == '-f' ]] || [ ! -f ~/.nolock ]
then
	# check if notifications were paused
	NOTIFICATIONS_PAUSED=$(dunstctl is-paused)

	# deactivate notifications
	dunstctl set-paused true
	echo pausing notifications

	# lock screen
	echo locking screen
	i3lock -i ~/.lockscreen.png

	# reactivate notifications if needed
	if echo $NOTIFICATIONS_PAUSED | grep -q "false"
	then
		echo unpausing notifications
		dunstctl set-paused false
	fi
fi
